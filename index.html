<!-- happy -->
<!DOCTYPE html>

<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="description" content="ProffieOS Style Editor: Customize your Proffieboard saber blade animations with this browser based tool.">
  <link rel="shortcut icon" type="image/png" href="./assets/SE_Favicon_BC-C5gxpSYq.png">
  <title>ProffieOS Style Editor</title>


<!-- Background image courtesy of 3D Artist Harold (TALON-3D) Okafor-Withers
https://www.artstation.com/haroldokaforwithers
https://www.renderhub.com/talon-3d
https://www.cgtrader.com/designers/talon-3d -->

  <script type="module" crossorigin src="./assets/index-DYgi9hQO.js"></script>
  <link rel="stylesheet" crossorigin href="./assets/index-DgynW2UF.css">
</head>
<body>
  <script defer src="pcb_draw.js"></script>
  <div class="main-container">
    <div class="header-container fullscreen">
      <span class="header-title">ProffieOS Style Editor</span>
      <span class="header-links">
        <span class="other-sites">Other sites: </span>
        <a href="https://crucible.hubbe.net/" target="_blank"><img src="https://crucible.hubbe.net/uploads/default/optimized/1X/2237f551ca8f4f69ac478df5c64aee1c951c33f5_2_180x180.png" alt="Crucible logo"></a>
        <a href="https://pod.hubbe.net/" target="_blank"><img src="https://pod.hubbe.net/images/favicon.png" alt="Pod logo"></a>
        <a href="https://fredrik.hubbe.net/lightsaber/" target="_blank"><img src="https://fredrik.hubbe.net/favicon.ico" alt="Lightsaber logo"></a>
        <a href="https://www.soundfontnamingconverter.com/" target="_blank"><img src="https://www.soundfontnamingconverter.com/favicon.png" alt="SFNC logo"></a>
        <a href="https://www.fett263.com/" target="_blank"><img src="https://www.fett263.com//favicon.ico" alt="Fett263 logo"></a>
        <a href="https://www.facebook.com/groups/opensourcesabers/" target="_blank"><img src="https://www.facebook.com/favicon.ico" alt="Facebook logo"></a>
        <a href="https://www.artstation.com/haroldokaforwithers/" target="_blank"><img src="https://www.artstation.com/favicon.ico" alt="ArtistPage logo"></a>
      </span>
    </div>

    <div class="page-left">
      <div id="page_left_top" class="page-left-top fullscreen">
        <div id="canvas-container" class="canvas-container">
          <canvas
            id="canvas_id"
            title="Blade Preview. Move mouse to swing.
Click to Clash or to Do Selected Effect (and to dismiss this Tooltip.)
Goto settings to change hilt model or toggle Mouse Swings mode (swinging with mouse moves.)"
            onmousemove="mouse_move(event)" onmouseleave="mouse_leave(event)"
            onclick="AddClickedEffect()">
          </canvas>
          <canvas
            id="pcb_canvas" class="pcb-canvas hidden"
            title="PCB preview - Shows LEDs on a pogo-pin blade emitter PCB.">
          </canvas>
          <select id="previewType" class="preview-type"
            title="Choose preview type">
            <option value="blade">Blade</option>
            <option value="PCBa">SCW NPXL V3-V4 Connector</option>
            <option value="PCBb">SCW ECO NPXL V4 Connector</option>
            <option value="PCBc">SCW NPXL Blade side pcb with 5-pixels</option>
            <option value="PCBd">SCW NPXL Blade side pcb with 6-pixels</option>
            <option value="PCBe">SCW MTRX 64 Pixel rectangular</option>
            <option value="PCBf">SCW MTRX 69 Pixel round</option>
            <option value="PCBg">Pixel ring</option>
          </select>
          <select id="pixelRingCount" class="pixel-ring-count hidden"
            title="Number of LEDs on pixel ring">
          </select>
          <button
            id="ENLARGE_BUTTON"
            title="Click to toggle blade preview window size.">Enlarge</button>
          <button
            id="FULLSCREEN_BUTTON"
            title="Click to view full screen.">Fullscreen</button>
        </div> <!-- canvas-container -->
        <div class="controls-row">
          <div id="control-buttons-strip">
            <button
              id="POWER_BUTTON"
              title="Turn the blade On and Off. Simulates ignition and retraction events on the blade."
              onclick="ClickPower()">Power</button>
            <button
              title="Simulates an impact hit on the blade. Triggers style code using EFFECT_CLASH."
              onclick="AddClash()">Clash</button>
            <button
              title="Simulates an impact hit on the tip of the blade. Triggers style code using EFFECT_STAB."
              onclick="AddStab()">Stab</button>
            <button
              title="Simulates a blaster bolt deflection impact hit on the blade. Triggers style code using EFFECT_BLAST."
              onclick="AddBlast()">Blast</button>
            <button
              title="Triggers style code using EFFECT_FORCE."
              onclick="AddForce()">Force</button>
            <button
              title="Simulates Accent Swings."
              onclick="AddSwing()">Swing</button>
            <select id="LOCKUP" name="lockup" title="Choose Lockup dropdown menu." onchange="OnLockupChange()"></select>
            <span class="more-menu-container">
              <select
                id="more_effects_menu"
                title="This menu contains all of the additional EFFECTS. Select one, then use the &quot;Do Selected Effect&quot; button to trigger the effect." >
              <option value="">Select More Effects</option>
              </select>
              <input
                type="button" id="do_selected" value="Do Selected Effect"
                title="Press this to trigger the EFFECT selected in the More Effects menu.">
            </span> <!-- more-menu-container -->
          </div> <!-- control-buttons-strip -->
          <div class="controls">
            <span class="variant-alt-container">
              <span class="variant-alt-controls">
                <span class="variant-label">Variant:</span>
                <input
                  id="VARIANT_SLIDER" name="varslider" type="range" class="variant-slider"
                  title="Slide to adjust the Variant value."
                  min="0" max="32768" step="1" value="0"
                  oninput="updateVariantValue(this.value)" >
                <input
                  id="VARIANT_MINUS" name="varminus" type="button" value="<"
                  title="Decreases the Variant value. Hold to increase speed of the changing value."
                  onmousedown="startAdjustingValue(-1, 'VARIANT_SLIDER')"
                  onmouseup="stopAdjustingValue()"
                  onmouseleave="stopAdjustingValue()" >
                <input
                  id="VARIANT_VALUE" name="varvalue" type="text" size="6" value="0" class="nofocus"
                  title="The current Variant value. You can also type in this field for direct entry of a value."
                  oninput="updateVariantValue(this.value)"
                  onfocusout="ValidateInput(event)" >
                <input
                  id="VARIANT_PLUS" name="varplus" type="button" value=">"
                  title="Increases the Variant value. Hold to increase speed of the changing value."
                  onmousedown="startAdjustingValue(1, 'VARIANT_SLIDER')"
                  onmouseup="stopAdjustingValue()"
                  onmouseleave="stopAdjustingValue()" >
                <span class="alt-label">Alt:</span>
                <input
                  id="ALT_MINUS" name="altminus" type="button" value="<"
                  title="Decreases the Alt value."
                  onclick="IncreaseAlt(-1)" >
                <input
                  id="ALT_VALUE" name="alt" type="text" size="6" value="0" class="nofocus"
                  title="The current Alt value. You can also type in this field for direct entry of a value."
                  oninput="updateAltValue(this.value)"
                  onfocusout="ValidateInput(event)" >
                <input
                  id="ALT_PLUS" name="altplus" type="button" value=">"
                  title="Increases the Alt value."
                  onclick="IncreaseAlt(1)" >
              </span>
            </span> <!-- variant-alt-container -->
            <span class="sound-container">
              <span class="sound-controls">
                <label class="sound-label" title="Enable or disable sound.">
                  <input type="checkbox" id="SOUND_BUTTON" name="usesounds" onclick="handleSettings(this)">
                  <span id="sound-toggle-icon-wrap">
                    <i id="sound-toggle-icon" class="fa-solid fa-volume-high"></i>
                  </span>
                  <span>Sound</span>
                </label>
                <label class="sound-label" title="Set playback volume.">
                  <span>Volume:</span>
                  <input type="range" id="VOLUME_SLIDER" class="variant-slider" min="0" max="100" value="80">
                  <span id="VOLUME_VALUE">80</span>
                </label>
                <label class="sound-label" title="Choose saber font.">
                  <span>Choose Font:</span>
                  <button type="button" class="sound-btn" id="choose_local_font">
                    <span id="choose_local_font_label">Liquid Static</span>
                  </button>
                  <input type="file" id="files" name="files" webkitdirectory directory multiple style="display:none;">
                  <span id="local_font_name"></span>
                </label>
              </span> <!-- sound-controls -->
            </span> <!-- sound-container -->
          </div> <!-- controls -->
        </div>  <!-- controls-row -->
      </div>  <!-- page-left-top -->


      <div id="page_left_bottom" class="page-left-bottom">
        <span id="error_message" class="error-message"></span>
        <textarea
          rows="10" cols="80" id="style" wrap="off" class="textbox"
          title="Style and value editing area. Edits in here are committed by clicking the Submit button below.">
        </textarea>

        <div class="actions-row">
          <span class="action-buttons-strip">
            <button
              id="SUBMIT_BUTTON" class="submit-button" title="Submit what is currently in the text box above."
              onclick="Run()">
              <i class="fa-solid fa-right-from-bracket"></i> Submit</button>
            <button
              id="COPY_BUTTON" title="Adds StylePtr&lt;&gt;() wrapper and copies the style to the clipboard."
              onclick="Copy()">
              <i class="fa-solid fa-copy"></i> Copy</button>
            <button
              id="EXPAND_BUTTON"
              title="Reveals the &quot;under the hood&quot; code that the shorthand macro uses.
  This allows access to otherwise omitted arguments, and allows functions to be used instead of just numbers.
  It is only an active button when applicable."
              onclick="DoExpand()">
              <i class="fa-solid fa-up-right-and-down-left-from-center"></i> Expand</button>
            <button
              id="LAYERIZE_BUTTON"
              title="Transforms nested version style code and breaks it out into more contemporary Layers format."
              onclick="DoLayerize()">
              <i class="fa-solid fa-layer-group"></i> Layerize</button>
            <button
              id="ARGIFY_BUTTON" title="Converts arguments to their ARG version counterparts for use with ProffieOS Workbench or Edit Mode. See the &quot;ArgString&quot; tab below."
              onclick="DoArgify()">
              <i class="fa-solid fa-list"></i> Argify</button>
            <button
              id="ROTATE_BUTTON" title="Toggles animation of the preview blade above."
              onclick="ClickRotate()">
              <i class="fa-solid fa-arrows-rotate"></i> Rotate</button>
            <button
              id="SAVE_BUTTON" title="Save the blade style to your computer."
              onclick="ClickSave()">
              <i class="fa-solid fa-save"></i> Save</button>
          </span>  <!-- action-buttons-strip -->
          <span class="settings-button-strip">
            <button
              id="SETTINGS_BUTTON" class="settings-button" title="Settings"
              onclick="toggleSettingsPanel()">
              <i class="fa-solid fa-cog"></i> Settings</button>
          </span>  <!-- settings-button-strip -->
        </div>  <!-- actions-row -->

        <div id="settings_panel" class="settings-panel"
          title="Turning on checkboxes saves your settings for future visits to the Style Editor page.">
          <button
           title="Close Settings Panel."
            class="close-settings" onclick="toggleSettingsPanel()">X</button>
          <h2 class="settings-header-label" title="Settings Panel">Settings</h2>

          <p title="How to get info on items..">
            Enable Tool Tips and hover items for info.
          </p>
          <br>
          <section class="settings-section">
            <h4 class="settings-section-label" title="These settings apply to the whole page.">General:</h4>
            <label title="Toggles a Dark Mode look to this page.">
              <input type="checkbox" id="DARK_BUTTON" name="darkmode" onclick="handleSettings(this)">
              <span>Dark mode</span>
            </label>
            <label title="Toggles pop-up tooltips On or Off.">
              <input type="checkbox" id="TIPS_BUTTON" name="tooltips" onclick="handleSettings(this)">
              <span >Tool tips</span>
            </label>
            <label title="Toggle sorting the Colors tab by hue or by name.">
              <input type="checkbox" id="COLOR_SORT_BUTTON" name="colorsort" onclick="handleSettings(this)">
              <span>Sort Colors tab by name</span>
            </label>
          </section> <!-- settings-section General -->

          <section class="settings-section">
            <h4 class="settings-section-label" title="These settings apply to the blade preview above.">Blade Preview:</h4>
            <label title="Toggles background image on or off. 
Background image courtesy of 3D Artist Harold (TALON-3D) Okafor-Withers
https://www.artstation.com/haroldokaforwithers
https://www.renderhub.com/talon-3d
https://www.cgtrader.com/designers/talon-3d">
              <input type="checkbox" id="BACKGROUND_BUTTON" name="background" onclick="handleSettings(this)">
              <span>Show background image</span>
            </label>
            <label title="Toggles the option for swinging around the preview blade above using mouse control.">
              <input type="checkbox" id="MOUSE_SWINGS_BUTTON" name="mouseswings" onclick="handleSettings(this)">
              <span>Disable mouse swings</span>
            </label>
            <label title="Show motion trails behind the blade in the preview.">
              <input type="checkbox" id="BLADE_TRAILS_BUTTON" name="bladetrails" onclick="handleSettings(this)">
              <span>Show blade swing trails</span>
            </label>
            <label title="Toggles automated swing emulation on the preview blade while at rest (ie: shown when using SwingSpeed<>). Swinging while hovering over the preview area always shows swing blade effects according to movements.">
              <input type="checkbox" id="AUTOSWING_BUTTON" name="autoswing" onclick="handleSettings(this)">
              <span>Swing emulation</span>
            </label>
            <label title="Simulates In-Hilt LED blades, (no addressable pixel effects).">
              <input type="checkbox" id="INHILT_BUTTON" name="inhilt" onclick="handleSettings(this)">
              <span>Inhilt LED</span>
            </label>
            <label title="Provides &quot;snapshots&quot; of rapidly moving things to see what they look like without fast movement.">
              <input type="checkbox" id="SLOW_BUTTON" name="slow" onclick="handleSettings(this)">
              <span>Slow-motion animations</span>
            </label>
          </section> <!-- settings-section Blade Preview -->

          <section class="settings-section">
            <h4 class="settings-section-label" title="These settings apply to the PCB preview above.">PCB Preview:</h4>
            <label title="Toggles the PCB to act as either a dedicated blade or as in parallel with main blade.">
              <input type="checkbox" id="PCB_DEDICATED_BUTTON" name="pcbdedicated" onclick="handleSettings(this)">
              <span>PCB is wired as its own blade</span>
            </label>
            <label title="Show pixel numbers on PCB LEDs.">
              <input type="checkbox" id="PCB_SHOW_LED_NUMBERS_BUTTON" name="pcbshowlednumbers" onclick="handleSettings(this)">
              <span>Show LED numbers</span>
            </label>
            <label title="Keep blade preview visible when viewing PCBs.">
              <input type="checkbox" id="PCB_VIEW_PLUS_BLADE_BUTTON" name="pcbviewplusblade" onclick="handleSettings(this)">
              <span>Keep blade preview visible with PCB</span>
            </label>
          </section> <!-- settings-section PCB Preview -->

          <section class="settings-section">
            <h4 class="settings-section-label" title="These settings apply Sound settings..">Sound Settings:</h4>
            <label title="Use default font sounds to fill in for missing loaded font sounds.">
              <input type="checkbox" id="FONT_FALLBACK_BUTTON" name="fontfallback" onclick="handleSettings(this)">
              <span>Fallback font sounds</span>
            </label>
             <section class="wavlen-controls">
               <section class="wavlen-row">
                 <label for="USE_FONT_WAVLEN_BUTTON">
                   <input type="checkbox" id="USE_FONT_WAVLEN_BUTTON" class="use-font-wavlen" onclick="handleSettings(this)">
                   <span title="Use loaded font to set WavLen for each EFFECT. Note: Turning this option ON will disable the Global WavLen time below.">
                     Use loaded font for WavLen&lt;&gt;
                   </span>
                 </label>
               </section>
               <br>
               <label
                 id="wavlen-global-label" class="wavlen-global-label" title="Set a global WavLen duration in milliseconds.">
                   Global WavLen time:
                 <input
                   type="text" id="WAVLEN_VALUE" class="wavlen-value nofocus" size="6" value="500">
               </label>
             </section>
          </section> <!-- settings-section Sound Settings -->

          <div class="settings-section">
            <h4 class="settings-section-label" title="These settings are useful for people making modifications to the style editor.">Developer Settings:</h4>
            <label title="Benchmark how many passes we can render per frame.">
              <input type="checkbox" id="BENCHMARK_BUTTON" name="benchmark" onclick="handleSettings(this)">
              <span>Benchmark</span>
            </label>
          </div> <!-- settings-section Developer Settings -->
          <br>
          <button
            title="Restore all settings to default, including restoring popups."
            id="restore_defaults" class="restore-defaults-btn" onclick="ClickRestore()">Restore Defaults</button>
        </div> <!--  settings panel -->

        <div id=TABS>
          <div id=TABLINKS class=tab></div>
          <div id=TABBODIES></div>
        </div> <!-- TABS -->
      </div> <!-- page-left-bottom -->
    </div> <!-- page-left -->
    <div class="splitter" id="splitter"></div>
    <div class="page-right">
      <div id="structured_view" class="structured-view">
        <span class="structured-view-label">Structured view, click to edit.</span>
        <div id="pp" class="pp"></div>
      </div>
    </div>
  </div> <!-- main-container -->
  <div id="start-overlay">
    <div class="start-overlay-box">
      <p>Welcome to the ProffieOS Style Editor!</p>
      <p class="start-overlay-sub">
        <br>Click anywhere to get started.<br><br><br>
        <!-- profezzorn & NoSloppy 2025 -->
      </p>
    </div>
  </div>
  <script defer src="style_editor.js"></script>
  <script defer src="sound.js"></script>
  <img id="pcba_image" src="./pcb_images/PCBa.png" style="display:none;">
  <img id="pcbb_image" src="./pcb_images/PCBb.png" style="display:none;">
  <img id="pcbc_image" src="./pcb_images/PCBc.png" style="display:none;">
  <img id="pcbd_image" src="./pcb_images/PCBd.png" style="display:none;">
  <img id="pcbe_image" src="./pcb_images/PCBe.png" style="display:none;">
  <img id="pcbf_image" src="./pcb_images/PCBf.png" style="display:none;">
  <img id="pcbg11_image" src="./pcb_images/PCBg11.png" style="display:none;">
  <img id="pcbg16_image" src="./pcb_images/PCBg16.png" style="display:none;">
  <img id="pcbg20_image" src="./pcb_images/PCBg20.png" style="display:none;">
  </body>
</html>
